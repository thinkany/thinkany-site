"use strict";

var taTheme = function () {
  "use strict";

  var onceInstantiatedModules;
  var $measureLi;
  var $getWidth;

  function init($) {
    onceInstantiatedModules = ["taTheme", "taHeader"];
    taHeader.init();
    init_modules();
  }

  function init_modules() {
    $("body #content-wrapper").addClass("ready");
    Object.getOwnPropertyNames(window).forEach(function (name) {
      if (name.indexOf("ta") < 0 || onceInstantiatedModules.indexOf(name) > -1 || !window[name].hasOwnProperty("init")) {
        return;
      }

      var _instance = window[name];

      _instance.init();
    });
    taLazy(); //expandMenu();
    // const iconMenu = document.querySelector(".mobile-ham");
    // const menu = document.querySelector(".mobile-menu");
    // const overlay = document.querySelector(".menu-overlay");

    var main = document.querySelector("#main");
    var foot = document.querySelector("#footer"); // iconMenu.addEventListener('click', function() {
    //     this.classList.toggle('active');
    //     menu.classList.toggle('active');
    //     overlay.classList.toggle('active');
    //     main.classList.toggle('blur');
    //     foot.classList.toggle('blur');
    // });
    // $(window).on("orientationchange", function (event) {
    //   location.reload();
    //   AOS.refresh();
    // });
    // var svg = document.getElementsByClassName("svg")[0];
    // var bbox = svg.getBBox();
    // var viewBox = [bbox.x, bbox.y, bbox.width, bbox.height].join(" ");
    // svg.setAttribute("viewBox", viewBox);
    // prompt("Copy to clipboard: Ctrl+C, Enter", svg.outerHTML);
  } // end init_modules
  // function expandMenu() {
  //   $(".site-header__nav ul a .indicator").on("click", function (event) {
  //     event.preventDefault();
  //     $("body").toggleClass("open");
  //     if ($(this).parent().hasClass("open")) {
  //       $(this).parent().removeClass("open");
  //     } else {
  //       $(this).parent().addClass("open");
  //     }
  //   });
  // }
  // function isIE() {
  //   var jscriptVersion = new Function(
  //     "/*@cc_on return @_jscript_version; @*/"
  //   )();
  //   return jscriptVersion != undefined ||
  //     (!!window.MSInputMethodContext && !!document.documentMode) ? true : false;
  // }


  return {
    init: init,
    init_modules: init_modules
  };
}(); // (function($){


$(document).ready(function () {
  taTheme.init();
}); // });

var NHHeader = function () {
  'use strict';

  var _$header;

  var $menuParent;
  var $mainMenuTopLink;
  var $body;
  var $buttons;
  var $header;
  var $heroScroller;
  var $heroScrollerID;
  var $iconMenu;
  var $mobileMenu;
  var $footerSlider;
  var $prevScrollpos = window.pageYOffset;
  var debounce_timer;
  var openMobileNav;
  var $menuTracker;
  var $overlay;
  var isOnScreen;

  function init() {
    $body = $('html, body');
    $header = $('#main-header');
    $menuTracker = $('#header-tracker');
    $heroScroller = $('#main-content-area section:first-child .scroll-indicator');
    $heroScrollerID = $('#main-content-area section:first-child').attr('id');
    $buttons = $('.sec .container .btn');
    $iconMenu = $('header .mobile-ham');
    $mobileMenu = $('header #menu-main-nav');
    $overlay = $('.menu-overlay');
    $footerSlider = $('#main-footer .container .wrapper-slider'); // if ( AOS && AOS !== undefined ) {
    // 	AOS.init({
    // 		once: false,
    // 		startEvent: 'load' // run backward and forward
    // 	});
    // 	window.addEventListener('load', function() {
    // 		AOS.refresh();
    // 	});
    // }

    var bottom = $heroScroller.offset().top + $heroScroller.outerHeight(true) - 300;
    $menuTracker.css({
      'top': bottom + 'px'
    });
    events();
  }

  function events() {
    // add supportive span to button elements
    if ($buttons.length) {
      $.each($buttons, function () {
        $(this).wrapInner('<span></span>');
      });
    } // // Handle flyout nav
    // //
    // $iconMenu.on('click', function(e) {
    // 	e.stopImmediatePropagation();
    // 	$body.toggleClass('open');		
    // 	$iconMenu.toggleClass('active');
    // 	$mobileMenu.toggleClass('open');
    // });
    // $overlay.on('click', function(e) {
    // 	$body.toggleClass('open');		
    // 	$iconMenu.toggleClass('active');
    // 	$mobileMenu.toggleClass('open');
    // });
    // $mobileMenu.on('click', function(e){
    // 	if ( $('header').hasClass('scrolled') ) {
    // 		setTimeout(function(){
    // 			$body.toggleClass('open');
    // 			$iconMenu.toggleClass('active');
    // 			$mobileMenu.toggleClass('open');
    // 		},350);
    // 	}
    // });
    // $footerSlider.on('click', function(e) {
    // 	e.stopImmediatePropagation();
    // 	$(this).closest('.container').toggleClass('open');
    // });
    // $heroScroller.on('click', function(e){
    // 	$('html,body').animate( { scrollTop: $(this).parents('section').next().offset().top }, 500); 
    // });
    // var winScrollTop = 0;
    // let observer = new IntersectionObserver(entries => {
    // 	winScrollTop = $(this).scrollTop();	
    // 	if (entries[0].boundingClientRect.y < 0) {
    // 		if( !($header.hasClass('scrolled')) ) {
    // 			$('#main-header').addClass('scrolled');
    // 		}
    // 	} else {
    // 		if( ($header.hasClass('scrolled')) ) {
    // 			$('#main-header').removeClass('scrolled');
    // 		}
    // 	}
    // });
    // observer.observe( document.querySelector("#header-tracker") );
    // $.fn.is_on_screen = function(){    
    // 	var win = $(window);
    // 	var viewport = {
    // 		top : win.scrollTop(),
    // 		left : win.scrollLeft()
    // 	};
    // 	//viewport.right = viewport.left + win.width();
    // 	viewport.bottom = viewport.top + win.height();
    // 	var bounds = this.offset();
    // 	//bounds.right = bounds.left + this.outerWidth();
    // 	bounds.bottom = bounds.top + this.outerHeight();
    // 	return (!(viewport.bottom < bounds.top || viewport.top > bounds.bottom));
    // };
    // function parallax() { 
    // var scrolled = $(window).scrollTop();
    // var winHeight = $(window).height();
    //   $('*[data-type="parallax"]').each(function(){ 
    // 	   if ($(this).is_on_screen()) {
    // 		  var firstTop = $(this).offset().top;
    // 		  var depth = $(this).data('depth');
    // 		  var start = $(this).data('start');
    // 		  var stop  = $(this).data('stop');
    // 		  var scrolling =  ( (scrolled + winHeight) - firstTop );
    // 		  var movement = -(scrolling * (depth)) + start;
    // 		  if ( (movement * -1) <= stop ) {
    // 			var transalte3d = 'translate3d(0, ' + movement + 'px, 0)';
    // 			$(this).css("transform",transalte3d);
    // 		  }
    // 	 }
    //   });
    // }
    // $(window).scroll(function(e){
    //   parallax();
    // });

  }

  return {
    init: init
  };
}(); // Lazy load BG images


function NHLazy() {
  // document.addEventListener("DOMContentLoaded", function() {
  var lazyloadImages;

  if ("IntersectionObserver" in window) {
    var config = {
      rootMargin: '200px 0px 200px 0px',
      threshold: 0
    };
    lazyloadImages = document.querySelectorAll(".lazy");
    var imageObserver = new IntersectionObserver(function (entries, observer) {
      entries.forEach(function (entry) {
        if (entry.isIntersecting) {
          var image = entry.target;
          image.src = image.dataset.src;
          image.classList.remove("lazy");
          imageObserver.unobserve(image);
        }
      });
    }, config);
    lazyloadImages.forEach(function (image) {
      imageObserver.observe(image);
    });
  } else {
    var lazyloadThrottleTimeout;
    lazyloadImages = document.querySelectorAll(".lazy");
    init(lazyloadImages);
    document.addEventListener("scroll", lazyload);
    window.addEventListener("resize", lazyload);
    window.addEventListener("orientationChange", lazyload);
  } // });//event listener

}

function init(lazyloadImages) {
  var scrollTop = window.pageYOffset;

  for (var i = 0; i < lazyloadImages.length; i++) {
    if (lazyloadImages[i].offsetTop < window.innerHeight + scrollTop + 250) {
      lazyloadImages[i].src = lazyloadImages[i].dataset.src;
      lazyloadImages[i].classList.remove("lazy");
    }
  }
}

function lazyload() {
  if (lazyloadThrottleTimeout) {
    clearTimeout(lazyloadThrottleTimeout);
  }

  lazyloadThrottleTimeout = setTimeout(function () {
    var scrollTop = window.pageYOffset; // lazyloadImages.forEach(function(img) {
    //     if(img.offsetTop < (window.innerHeight + scrollTop)) {
    //       img.src = img.dataset.src;
    //       img.classList.remove("lazy");
    //     }
    // });

    for (var i = 0; i < lazyloadImages.length; i++) {
      if (lazyloadImages[i].offsetTop < window.innerHeight + scrollTop + 250) {
        lazyloadImages[i].src = lazyloadImages[i].dataset.src;
        lazyloadImages[i].classList.remove("lazy");
      }
    }

    if (lazyloadImages.length == 0) {
      document.removeEventListener("scroll", lazyload);
      window.removeEventListener("resize", lazyload);
      window.removeEventListener("orientationChange", lazyload);
    }
  }, 20);
}